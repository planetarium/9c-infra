name: Revert Pluggable Action Evaluator

on:
  workflow_dispatch:
    inputs:
      network_type:
        required: true
        default: odin
        type: choice
        options:
          - odin
          - heimdall
          - thor
        description: 'Which mainnet network to revert?'

jobs:
  revert-paev:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - uses: actions/setup-python@v2.2.2
        with:
          python-version: 3.10.13

      - name: install dependencies
        run: |
          python -m pip install -r requirements.txt
          flit install
        working-directory: ./scripts

      - name: Revert Pluggable Action Evaluator
        run: |
          python cli.py revert-paev ${{ github.event.inputs.network_type }}
        working-directory: ./scripts
        env:
          GITHUB_TOKEN: ${{ secrets.P_GITHUB_TOKEN }}
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
